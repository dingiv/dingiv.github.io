import{_ as s,o as e,c as a,j as Q,a as T,ah as l}from"./chunks/framework.BwbIerCg.js";const O=JSON.parse('{"title":"算子优化","description":"","frontmatter":{"title":"算子优化","order":30},"headers":[],"relativePath":"ai/compute/kernel/optimization.md","filePath":"ai/compute/kernel/optimization.md"}'),o={name:"ai/compute/kernel/optimization.md"},n={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.151ex",height:"1.805ex",role:"img",focusable:"false",viewBox:"0 -716 3602.6 798","aria-hidden":"true"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.116ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4913.2 1000","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.767ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4759.2 1000","aria-hidden":"true"},h={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.136ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4922.2 1000","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"7.529ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 3328 683","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.328ex",height:"1.731ex",role:"img",focusable:"false",viewBox:"0 -683 8100.9 765","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.974ex",height:"1.731ex",role:"img",focusable:"false",viewBox:"0 -683 8828.7 765","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.226ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 8056 1000","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.229ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 9825 1000","aria-hidden":"true"},M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.352ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 1481.7 636","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.109ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 490 647","aria-hidden":"true"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.352ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 1481.7 636","aria-hidden":"true"},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.109ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 490 647","aria-hidden":"true"},S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.832ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 2577.6 1083.9","aria-hidden":"true"},j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.847ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4352.3 1000","aria-hidden":"true"};function N(B,t,F,E,z,G){return e(),a("div",null,[t[50]||(t[50]=Q("h1",{id:"算子优化",tabindex:"-1"},[T("算子优化 "),Q("a",{class:"header-anchor",href:"#算子优化","aria-label":"Permalink to “算子优化”"},"​")],-1)),t[51]||(t[51]=Q("p",null,"算子是深度学习模型计算的基本单元，如矩阵乘法、卷积、注意力等。算子优化通过改进 CUDA kernel 实现，提升单算子的计算效率，是提升模型性能的基础。相比于框架层面的优化（如分布式策略），算子优化更贴近硬件，收益稳定且可迁移。",-1)),t[52]||(t[52]=Q("h2",{id:"性能瓶颈",tabindex:"-1"},[T("性能瓶颈 "),Q("a",{class:"header-anchor",href:"#性能瓶颈","aria-label":"Permalink to “性能瓶颈”"},"​")],-1)),t[53]||(t[53]=Q("p",null,[T("GPU 计算的理论性能由 FLOPS 衡量，但实际性能受限于"),Q("strong",null,"内存带宽"),T("和"),Q("strong",null,"延迟"),T("。A100 的 FP16 理论性能为 312 TFLOPS，显存带宽 2TB/s，这意味着每个浮点运算需要访存约 6.4 字节才能充分利用计算单元。但深度学习算子的算术强度（arithmetic intensity，计算量/访存量）往往低于此阈值，导致性能受限于内存带宽而非计算单元。")],-1)),Q("p",null,[t[16]||(t[16]=T("以矩阵乘法 ",-1)),Q("mjx-container",n,[(e(),a("svg",r,[...t[0]||(t[0]=[l("",1)])])),t[1]||(t[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"C"),Q("mo",null,"="),Q("mi",null,"A"),Q("mi",null,"B")])],-1))]),t[17]||(t[17]=T(" 为例，其中 ",-1)),Q("mjx-container",i,[(e(),a("svg",d,[...t[2]||(t[2]=[l("",1)])])),t[3]||(t[3]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"A"),Q("mo",null,"∈"),Q("mo",{stretchy:"false"},"["),Q("mi",null,"M"),Q("mo",null,","),Q("mi",null,"K"),Q("mo",{stretchy:"false"},"]")])],-1))]),t[18]||(t[18]=T("，",-1)),Q("mjx-container",m,[(e(),a("svg",p,[...t[4]||(t[4]=[l("",1)])])),t[5]||(t[5]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"B"),Q("mo",null,"∈"),Q("mo",{stretchy:"false"},"["),Q("mi",null,"K"),Q("mo",null,","),Q("mi",null,"N"),Q("mo",{stretchy:"false"},"]")])],-1))]),t[19]||(t[19]=T("，",-1)),Q("mjx-container",h,[(e(),a("svg",g,[...t[6]||(t[6]=[l("",1)])])),t[7]||(t[7]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"C"),Q("mo",null,"∈"),Q("mo",{stretchy:"false"},"["),Q("mi",null,"M"),Q("mo",null,","),Q("mi",null,"N"),Q("mo",{stretchy:"false"},"]")])],-1))]),t[20]||(t[20]=T("。标准算法需要 ",-1)),Q("mjx-container",x,[(e(),a("svg",w,[...t[8]||(t[8]=[l("",1)])])),t[9]||(t[9]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mn",null,"2"),Q("mi",null,"M"),Q("mi",null,"N"),Q("mi",null,"K")])],-1))]),t[21]||(t[21]=T(" 次 FLOPs，访存 ",-1)),Q("mjx-container",H,[(e(),a("svg",u,[...t[10]||(t[10]=[l("",1)])])),t[11]||(t[11]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M"),Q("mi",null,"N"),Q("mo",null,"+"),Q("mi",null,"N"),Q("mi",null,"K"),Q("mo",null,"+"),Q("mi",null,"M"),Q("mi",null,"K")])],-1))]),t[22]||(t[22]=T(" 个元素。当 ",-1)),Q("mjx-container",L,[(e(),a("svg",c,[...t[12]||(t[12]=[l("",1)])])),t[13]||(t[13]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M"),Q("mo",null,"="),Q("mi",null,"N"),Q("mo",null,"="),Q("mi",null,"K"),Q("mo",null,"="),Q("mn",null,"4096")])],-1))]),t[23]||(t[23]=T(" 时，算术强度为 ",-1)),Q("mjx-container",f,[(e(),a("svg",V,[...t[14]||(t[14]=[l("",1)])])),t[15]||(t[15]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mn",null,"2"),Q("mo",null,"×"),Q("mn",null,"4096"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mn",null,"3"),Q("mo",null,"≈"),Q("mn",null,"2730")])],-1))]),t[24]||(t[24]=T(" FLOPs/byte，远超 A100 的 6.4 FLOPs/byte 阈值，因此矩阵乘法是计算密集型（compute-bound）算子，性能受限于计算单元而非显存带宽。",-1))]),t[54]||(t[54]=Q("p",null,"但对于逐元素操作（如 ReLU、Add），算术强度接近于 0，因为每个元素需要读写显存但计算量很少。这类算子的性能受限于显存带宽，优化方向是减少访存次数（如算子融合）。",-1)),t[55]||(t[55]=Q("p",null,[T("另一个瓶颈是 "),Q("strong",null,"warp divergence"),T("。CUDA 以 warp（32 个线程）为单位执行指令，如果 warp 中的线程走不同分支（如 if-else），则需要串行执行各分支，降低并行度。这要求 kernel 设计时尽量保证 warp 内线程路径一致。")],-1)),t[56]||(t[56]=Q("h2",{id:"优化技术",tabindex:"-1"},[T("优化技术 "),Q("a",{class:"header-anchor",href:"#优化技术","aria-label":"Permalink to “优化技术”"},"​")],-1)),t[57]||(t[57]=Q("p",null,"共享内存（shared memory）是 GPU 片上内存，带宽远高于全局显存（A100 的 shared memory 带宽约 20TB/s，global memory 约 2TB/s）。通过将频繁访问的数据加载到 shared memory，可大幅减少全局显存访问。矩阵乘法的 tiling 算法就是典型例子：将矩阵块加载到 shared memory 后，块内计算无需再次访问全局显存。",-1)),Q("p",null,[t[35]||(t[35]=T("算子融合通过将多个连续算子合并为一个 kernel 来减少显存读写。例如 LayerNorm 后接 Residual (",-1)),Q("mjx-container",k,[(e(),a("svg",y,[...t[25]||(t[25]=[l("",1)])])),t[26]||(t[26]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"y"),Q("mo",null,"="),Q("mtext",null,"LayerNorm"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",null,"+"),Q("mi",null,"z"),Q("mo",{stretchy:"false"},")")])],-1))]),t[36]||(t[36]=T(")，标准实现需要读写显存三次（读 ",-1)),Q("mjx-container",M,[(e(),a("svg",v,[...t[27]||(t[27]=[l("",1)])])),t[28]||(t[28]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"x"),Q("mo",null,","),Q("mi",null,"z")])],-1))]),t[37]||(t[37]=T("，写中间结果，读中间结果，写 ",-1)),Q("mjx-container",b,[(e(),a("svg",Z,[...t[29]||(t[29]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D466",d:"M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),t[30]||(t[30]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"y")])],-1))]),t[38]||(t[38]=T("），融合后只需一次读写（读 ",-1)),Q("mjx-container",_,[(e(),a("svg",C,[...t[31]||(t[31]=[l("",1)])])),t[32]||(t[32]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"x"),Q("mo",null,","),Q("mi",null,"z")])],-1))]),t[39]||(t[39]=T("，写 ",-1)),Q("mjx-container",D,[(e(),a("svg",A,[...t[33]||(t[33]=[Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D466",d:"M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),t[34]||(t[34]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"y")])],-1))]),t[40]||(t[40]=T("）。FlashAttention 更是将 Attention 的多次分块计算融合为单个 kernel，将显存访问减少 10 倍以上。",-1))]),t[58]||(t[58]=l("",9)),Q("p",null,[t[45]||(t[45]=T("第二步是",-1)),t[46]||(t[46]=Q("strong",null,"算法优化",-1)),t[47]||(t[47]=T("。选择更优的算法可减少 FLOPs，如 Winograd 卷积将 FLOPs 降低 2-3 倍，FFT 卷积将 ",-1)),Q("mjx-container",S,[(e(),a("svg",P,[...t[41]||(t[41]=[l("",1)])])),t[42]||(t[42]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"O"),Q("mo",{stretchy:"false"},"("),Q("msup",null,[Q("mi",null,"n"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")")])],-1))]),t[48]||(t[48]=T(" 降为 ",-1)),Q("mjx-container",j,[(e(),a("svg",I,[...t[43]||(t[43]=[l("",1)])])),t[44]||(t[44]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"O"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"n"),Q("mi",null,"log"),Q("mo",{"data-mjx-texclass":"NONE"},"⁡"),Q("mi",null,"n"),Q("mo",{stretchy:"false"},")")])],-1))]),t[49]||(t[49]=T("。但算法优化可能改变数值精度，需要验证。",-1))]),t[59]||(t[59]=Q("p",null,[T("第三步是"),Q("strong",null,"实现优化"),T("。使用 shared memory tiling、Tensor Core、指令级并行等技术提升 kernel 效率。这一步需要反复 benchmark，调整分块大小、展开循环、融合算子，直到接近理论性能峰值。")],-1)),t[60]||(t[60]=Q("p",null,[T("最后是"),Q("strong",null,"集成测试"),T("。将优化后的算子集成到模型中，验证端到端性能提升和数值正确性。有时算子层面优化了 50%，但模型层面仅提升 5%，因为瓶颈转移到其他算子。")],-1))])}const J=s(o,[["render",N]]);export{O as __pageData,J as default};
