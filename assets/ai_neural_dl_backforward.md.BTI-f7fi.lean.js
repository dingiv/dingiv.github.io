import{_ as s,o as T,c as e,ah as l,j as t,a}from"./chunks/framework.BvDvRtye.js";const I=JSON.parse('{"title":"反向传播","description":"","frontmatter":{},"headers":[],"relativePath":"ai/neural/dl/backforward.md","filePath":"ai/neural/dl/backforward.md"}'),o={name:"ai/neural/dl/backforward.md"},n={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"20.51ex",height:"2.46ex",role:"img",focusable:"false",viewBox:"0 -893.3 9065.6 1087.3","aria-hidden":"true"},p={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"38.845ex",height:"2.7ex",role:"img",focusable:"false",viewBox:"0 -943.3 17169.6 1193.3","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.984ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.016ex",height:"3.019ex",role:"img",focusable:"false",viewBox:"0 -899.6 2217 1334.5","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 681 683","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.371ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 1048 705","aria-hidden":"true"},f={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.813ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.396ex",height:"5.363ex",role:"img",focusable:"false",viewBox:"0 -1569.3 10340.9 2370.7","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.023ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.106ex",height:"2.044ex",role:"img",focusable:"false",viewBox:"0 -893.3 1372.8 903.3","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.674ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 298 705","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.984ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.097ex",height:"3.019ex",role:"img",focusable:"false",viewBox:"0 -899.6 1811 1334.5","aria-hidden":"true"},_={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.602ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.433ex",height:"4.749ex",role:"img",focusable:"false",viewBox:"0 -1391 8147.4 2099","aria-hidden":"true"},E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.124ex",height:"1.489ex",role:"img",focusable:"false",viewBox:"0 -442 497 658","aria-hidden":"true"};function j(C,Q,S,P,R,O){return T(),e("div",null,[Q[41]||(Q[41]=l("",8)),t("p",null,[Q[6]||(Q[6]=a("训练神经网络的核心难题在于如何计算梯度。对于一个包含 ",-1)),t("mjx-container",n,[(T(),e("svg",r,[...Q[0]||(Q[0]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)])])),Q[1]||(Q[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[7]||(Q[7]=a(" 层的网络，损失函数 ",-1)),t("mjx-container",d,[(T(),e("svg",m,[...Q[2]||(Q[2]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)])])),Q[3]||(Q[3]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[8]||(Q[8]=a(" 可以看作是权重 ",-1)),t("mjx-container",i,[(T(),e("svg",h,[...Q[4]||(Q[4]=[l("",1)])])),Q[5]||(Q[5]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])]),t("mo",null,","),t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"2"),t("mo",{stretchy:"false"},")")])]),t("mo",null,","),t("mo",null,"."),t("mo",null,"."),t("mo",null,"."),t("mo",null,","),t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"L"),t("mo",{stretchy:"false"},")")])])])],-1))]),Q[9]||(Q[9]=a(" 的复合函数：",-1))]),t("mjx-container",p,[(T(),e("svg",g,[...Q[10]||(Q[10]=[l("",1)])])),Q[11]||(Q[11]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"L"),t("mo",null,"="),t("msub",null,[t("mi",null,"f"),t("mi",null,"L")]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"f"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},"("),t("mo",null,"."),t("mo",null,"."),t("mo",null,"."),t("msub",null,[t("mi",null,"f"),t("mn",null,"1")]),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",null,","),t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",{stretchy:"false"},")")])]),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mo",null,"."),t("mo",null,"."),t("mo",null,"."),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"L"),t("mo",{stretchy:"false"},")")])]),t("mo",{stretchy:"false"},")")])],-1))]),t("p",null,[Q[14]||(Q[14]=a("要更新每个权重矩阵，需要计算 ",-1)),t("mjx-container",c,[(T(),e("svg",w,[...Q[12]||(Q[12]=[l("",1)])])),Q[13]||(Q[13]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])])])],-1))]),Q[15]||(Q[15]=a("。如果直接对整个复合函数求导，计算复杂度随层数指数级增长，这在深度网络上是完全不可行的。这就是为什么在反向传播算法提出之前，人们只能训练很浅的网络，也无法解决像 XOR 这样的非线性问题。",-1))]),Q[42]||(Q[42]=t("p",null,"另外，即使能够计算梯度，深层网络还会遇到梯度消失和梯度爆炸的问题。梯度在向前传播过程中可能会变得极小（导致浅层参数几乎不更新）或极大（导致训练发散），这使得训练超过几层的网络几乎不可能。这些难题在 20 世纪 80 年代被解决之前，神经网络研究经历了漫长的寒冬。",-1)),Q[43]||(Q[43]=t("h2",{id:"基本原理",tabindex:"-1"},[a("基本原理 "),t("a",{class:"header-anchor",href:"#基本原理","aria-label":"Permalink to “基本原理”"},"​")],-1)),Q[44]||(Q[44]=t("p",null,"反向传播是解决上述难题的关键算法，其核心思想是从后向前递归计算梯度。",-1)),t("p",null,[Q[20]||(Q[20]=a("根据链式法则，因为损失 ",-1)),t("mjx-container",x,[(T(),e("svg",u,[...Q[16]||(Q[16]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43F",d:"M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z",style:{"stroke-width":"3"}})])])],-1)])])),Q[17]||(Q[17]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"L")])],-1))]),Q[21]||(Q[21]=a(" 是权重 ",-1)),t("mjx-container",k,[(T(),e("svg",H,[...Q[18]||(Q[18]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D44A",d:"M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z",style:{"stroke-width":"3"}})])])],-1)])])),Q[19]||(Q[19]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"W")])],-1))]),Q[22]||(Q[22]=a(" 的复合函数，那么：",-1))]),t("mjx-container",f,[(T(),e("svg",y,[...Q[23]||(Q[23]=[l("",1)])])),Q[24]||(Q[24]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msup",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])]),t("mo",null,"⋅"),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msup",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])]),t("mrow",null,[t("mi",null,"∂"),t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])])])],-1))]),t("p",null,[Q[31]||(Q[31]=a("其中 ",-1)),t("mjx-container",L,[(T(),e("svg",M,[...Q[25]||(Q[25]=[l("",1)])])),Q[26]||(Q[26]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])],-1))]),Q[32]||(Q[32]=a(" 是第 ",-1)),t("mjx-container",b,[(T(),e("svg",Z,[...Q[27]||(Q[27]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D459",d:"M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z",style:{"stroke-width":"3"}})])])],-1)])])),Q[28]||(Q[28]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"l")])],-1))]),Q[33]||(Q[33]=a(" 层的输出。这个公式的意义在于：当前层的梯度等于后层传回的梯度乘以本地的梯度。反向传播从输出层开始，逐层向前计算 ",-1)),t("mjx-container",v,[(T(),e("svg",D,[...Q[29]||(Q[29]=[l("",1)])])),Q[30]||(Q[30]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("msup",null,[t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",null,"l"),t("mo",{stretchy:"false"},")")])])])])])],-1))]),Q[34]||(Q[34]=a("，每层只需要知道本层的输出和后层的梯度，无需关心更前面的层。",-1))]),Q[45]||(Q[45]=l("",14)),t("mjx-container",_,[(T(),e("svg",V,[...Q[35]||(Q[35]=[l("",1)])])),Q[36]||(Q[36]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"W"),t("mo",{stretchy:"false"},"←"),t("mi",null,"W"),t("mo",null,"−"),t("mi",null,"η"),t("mo",null,"⋅"),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"L")]),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"W")])])])],-1))]),t("p",null,[Q[39]||(Q[39]=a("其中 ",-1)),t("mjx-container",E,[(T(),e("svg",A,[...Q[37]||(Q[37]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D702",d:"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q156 442 175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336V326Q503 302 439 53Q381 -182 377 -189Q364 -216 332 -216Q319 -216 310 -208T299 -186Q299 -177 358 57L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),Q[38]||(Q[38]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"η")])],-1))]),Q[40]||(Q[40]=a(" 是学习率，控制参数更新的步长。学习率过大可能导致训练震荡甚至发散，过小则收敛太慢。现代优化器如 Adam、AdamW 会自适应地为每个参数调整学习率，在训练初期使用较大的学习率快速逼近最优解，后期逐渐减小学习率精细调优。",-1))]),Q[46]||(Q[46]=l("",18))])}const z=s(o,[["render",j]]);export{I as __pageData,z as default};
